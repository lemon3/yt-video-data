/*!
* YTVideoData v0.1.1
* https://github.com/lemon3/yt-video-data
*/
(function(a,i){typeof exports=="object"&&typeof module!="undefined"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(a=typeof globalThis!="undefined"?globalThis:a||self,i(a.YTVideoData={}))})(this,function(a){"use strict";var T=Object.defineProperty,b=Object.defineProperties;var g=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var u=(a,i,s)=>i in a?T(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s,w=(a,i)=>{for(var s in i||(i={}))_.call(i,s)&&u(a,s,i[s]);if(m)for(var s of m(i))I.call(i,s)&&u(a,s,i[s]);return a},f=(a,i)=>b(a,g(i));var h=(a,i,s)=>u(a,typeof i!="symbol"?i+"":i,s);var l=(a,i,s)=>new Promise((y,d)=>{var p=e=>{try{n(s.next(e))}catch(t){d(t)}},c=e=>{try{n(s.throw(e))}catch(t){d(t)}},n=e=>e.done?y(e.value):Promise.resolve(e.value).then(p,c);n((s=s.apply(a,i)).next())});const i=n=>{if(/^[a-zA-Z0-9_-]{11}$/.test(n))return n;{const e=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,t=n.match(e);return t&&t[7]&&t[7].length===11?t[7]:!1}},s=(n,e=window.document)=>{const t=e.createElement("script");t.src=n;const o=e.getElementsByTagName("script")[0];o&&o.parentNode?o.parentNode.insertBefore(t,o):e.body.append(t)},y={width:"160",height:"90",playerVars:{playsinline:0,autoplay:0,enablejsapi:0,iv_load_policy:3,controls:0,disablekb:1,showinfo:0,rel:0,fs:0}},d="youtube-api-ready",p="https://www.youtube.com/iframe_api";class c{constructor(){h(this,"initialized",!1);h(this,"_stateChange",({data:e})=>{this.promise&&e===1&&(this.player.mute().stopVideo().clearVideo(),this.promise.resolve(this._createData()))});h(this,"_playerReady",()=>{this.isPlayerReady=!0,this.player.mute(),this.player.setVolume(0)});this.isPlayerReady=!1,this.init()}_createData(){const e=this.player.playerInfo;let t=e.videoData.author;return t=t.replace("- Topic","").trim(),{title:this.player.videoTitle||e.videoData.title,author:t,videoId:e.videoData.video_id,videoUrl:e.videoUrl,duration:e.duration,poster:this.getPoster()}}_load(e){return l(this,null,function*(){return new Promise((t,o)=>{this.player.loadVideoById(e),this.promise={resolve:t,reject:o}})})}getInfo(e){return l(this,null,function*(){const t=i(e);return this.promise=null,new Promise((o,r)=>{this.initialized||r("not initialized"),t?e=t:r("not a valid video id"),this.videoId=e;const v=setInterval(()=>l(this,null,function*(){if(this.isPlayerReady){clearInterval(v);const P=yield this._load(e);o(P)}}),20)})})}_loadAPI(){return l(this,null,function*(){return new Promise((e,t)=>{if(window.YT&&window.YT.Player)return e(window.YT);const o=()=>{if(window.removeEventListener(d,o),window.YT)return e(window.YT);t(new Error("Failed to load YouTube API"))};if(window.addEventListener(d,o),!window.onYouTubeIframeAPIReady){const r=new Event(d);window.onYouTubeIframeAPIReady=()=>{window.dispatchEvent(r)},s(p)}})})}_createPlayer(){this.player=new this.yt.Player(this.div,f(w({},y),{videoId:"dQw4w9WgXcQ",events:{onReady:this._playerReady,onStateChange:this._stateChange}}))}getPoster(e=this.videoId){const t=`https://i.ytimg.com/vi/${e}/`;return["default","hqdefault","mqdefault","sddefault","maxresdefault","hq720"].reduce((o,r)=>f(w({},o),{[r]:`${t}${r}.jpg`}),{})}destroy(){!this.yt||!this.initialized||(this.player.destroy(),this.wrapper.remove(),this.initialized=!1)}init(){if(this.initialized)return this;this.initialized=!0;const e=document.createElement("div"),t=e.style;if(t.position="absolute",t.left="-200vw",t.opacity="0",t.visibility="hidden",this.div=document.createElement("div"),e.append(this.div),document.body.append(e),this.wrapper=e,window.YT&&window.YT.Player){this.yt=window.YT,this._createPlayer();return}l(this,null,function*(){this.yt=yield this._loadAPI(),this._createPlayer()})}}a.YTVideoData=c,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
